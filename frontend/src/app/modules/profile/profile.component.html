<div class="profile-container">
    <div class="form-profile">
        <div class="form-profile-header">
            <a class="button" routerLink="/dashboard">
                <span class="back-icon">‚Üê</span>
            </a>
            <h3>Mi Perfil</h3>
        </div>
        
        <div class="form-profile-body">
            <!-- Formulario -->
            <form [formGroup]="profileForm" (ngSubmit)="saveProfile()" class="profile-form">
                <!-- Nombre -->
                <div class="form-group">
                    <input 
                        type="text" 
                        placeholder="Nombre *" 
                        class="form-input"
                        formControlName="firstName"
                        autocomplete="given-name"
                        [class.is-invalid]="profileForm.get('firstName')?.invalid && profileForm.get('firstName')?.touched">
                    <div class="error-message" *ngIf="profileForm.get('firstName')?.invalid && profileForm.get('firstName')?.touched">
                        <span *ngIf="profileForm.get('firstName')?.errors?.['required']">El nombre es requerido</span>
                    </div>
                </div>

                <!-- Apellido -->
                <div class="form-group">
                    <input 
                        type="text" 
                        placeholder="Apellido" 
                        class="form-input"
                        formControlName="lastName"
                        autocomplete="family-name">
                </div>

                <!-- Email (solo lectura) -->
                <div class="form-group">
                    <input 
                        type="email" 
                        placeholder="Correo electr√≥nico" 
                        class="form-input"
                        [value]="userData?.email"
                        readonly
                        [class.readonly]="true">
                    <div class="readonly-note">El correo electr√≥nico no se puede modificar</div>
                </div>

                <!-- Tel√©fono -->
                <div class="form-group">
                    <div class="phone-container">
                        <input 
                            type="text" 
                            placeholder="+56" 
                            class="form-input country-code"
                            formControlName="countryCode"
                            maxlength="5">
                        <input 
                            type="tel" 
                            placeholder="N√∫mero de tel√©fono" 
                            class="form-input phone-number"
                            formControlName="phone"
                            autocomplete="tel"
                            [class.is-invalid]="profileForm.get('phone')?.invalid && profileForm.get('phone')?.touched">
                    </div>
                    <div class="error-message" *ngIf="profileForm.get('phone')?.invalid && profileForm.get('phone')?.touched">
                        <span *ngIf="profileForm.get('phone')?.errors?.['pattern']">Ingrese un n√∫mero de tel√©fono v√°lido</span>
                    </div>
                </div>

                <!-- Bot√≥n de guardar -->
                <button 
                    type="submit" 
                    class="save-button"
                    [disabled]="profileForm.invalid || profileForm.disabled || isLoading">
                    <span *ngIf="!isLoading">Guardar cambios</span>
                    <span *ngIf="isLoading" class="loading">
                        <span class="spinner"></span>
                        Guardando...
                    </span>
                </button>
            </form>
        </div>
        
        <div class="form-profile-footer"></div>
    </div>

    <!-- Secci√≥n de informaci√≥n del usuario a la derecha -->
    <div class="user-info-section">
        <div class="user-info-content">
            <div class="user-avatar">
                <span class="avatar-text">{{ getInitials() }}</span>
            </div>
            <h1 class="user-name">{{ userData?.firstName }} {{ userData?.lastName }}</h1>
            <p class="user-email">{{ userData?.email }}</p>
            <div class="user-plan">
                <span class="plan-badge">{{ getPlanName() }}</span>
                <span class="plan-price">{{ getPlanPrice() }}</span>
            </div>
            <div class="user-stats">
                <div class="stat">
                    <span class="stat-icon">üìä</span>
                    <span class="stat-text">Miembro desde {{ getMemberSince() }}</span>
                </div>
                <div class="stat">
                    <span class="stat-icon">üîí</span>
                    <span class="stat-text">Cuenta verificada</span>
                </div>
            </div>
        </div>
        <!-- Secci√≥n de acciones de cuenta -->
        <div class="account-actions-section">
            <h4 class="section-title">Acciones de cuenta</h4>
            
            <div class="action-buttons">
                <!-- Cambiar contrase√±a -->
                <button 
                    type="button" 
                    class="action-button change-password-button"
                    (click)="openChangePasswordDialog()">
                    <span class="action-icon">üîê</span>
                    <span class="action-text">Cambiar contrase√±a</span>
                </button>

                <!-- Gestionar facturaci√≥n -->
                <button 
                    type="button" 
                    class="action-button billing-button"
                    (click)="openBillingSection()">
                    <span class="action-icon">üí≥</span>
                    <span class="action-text">Gestionar facturaci√≥n</span>
                </button>

                <!-- Cerrar sesi√≥n -->
                <button 
                    type="button" 
                    class="action-button logout-button"
                    (click)="logout()">
                    <span class="action-icon">üö™</span>
                    <span class="action-text">Cerrar sesi√≥n</span>
                </button>
            </div>
        </div>
    </div>
</div>